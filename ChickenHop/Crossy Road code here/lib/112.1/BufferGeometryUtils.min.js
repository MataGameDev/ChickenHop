THREE.BufferGeometryUtils={computeTangents:function(r){var e=r.index,t=r.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,o=t.position.array,a=t.normal.array,i=t.uv.array,u=o.length/3;void 0===t.tangent&&r.setAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*u),4));for(var s=t.tangent.array,l=[],f=[],c=0;c<u;c++)l[c]=new THREE.Vector3,f[c]=new THREE.Vector3;var g=new THREE.Vector3,d=new THREE.Vector3,E=new THREE.Vector3,v=new THREE.Vector2,m=new THREE.Vector2,h=new THREE.Vector2,p=new THREE.Vector3,b=new THREE.Vector3,y=r.groups;0===y.length&&(y=[{start:0,count:n.length}]);c=0;for(var T=y.length;c<T;++c)for(var w=M=(D=y[c]).start,A=M+D.count;w<A;w+=3)X(n[w+0],n[w+1],n[w+2]);var R,H,B,S=new THREE.Vector3,x=new THREE.Vector3,V=new THREE.Vector3,z=new THREE.Vector3;for(c=0,T=y.length;c<T;++c){var D,M;for(w=M=(D=y[c]).start,A=M+D.count;w<A;w+=3)G(n[w+0]),G(n[w+1]),G(n[w+2])}}else console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function X(r,e,t){g.fromArray(o,3*r),d.fromArray(o,3*e),E.fromArray(o,3*t),v.fromArray(i,2*r),m.fromArray(i,2*e),h.fromArray(i,2*t),d.sub(g),E.sub(g),m.sub(v),h.sub(v);var n=1/(m.x*h.y-h.x*m.y);isFinite(n)&&(p.copy(d).multiplyScalar(h.y).addScaledVector(E,-m.y).multiplyScalar(n),b.copy(E).multiplyScalar(m.x).addScaledVector(d,-h.x).multiplyScalar(n),l[r].add(p),l[e].add(p),l[t].add(p),f[r].add(b),f[e].add(b),f[t].add(b))}function G(r){V.fromArray(a,3*r),z.copy(V),H=l[r],S.copy(H),S.sub(V.multiplyScalar(V.dot(H))).normalize(),x.crossVectors(z,H),B=x.dot(f[r]),R=B<0?-1:1,s[4*r]=S.x,s[4*r+1]=S.y,s[4*r+2]=S.z,s[4*r+3]=R}},mergeBufferGeometries:function(r,e){for(var t=null!==r[0].index,n=new Set(Object.keys(r[0].attributes)),o=new Set(Object.keys(r[0].morphAttributes)),a={},i={},u=r[0].morphTargetsRelative,s=new THREE.BufferGeometry,l=0,f=0;f<r.length;++f){var c=r[f];if(t!==(null!==c.index))return null;for(var g in c.attributes){if(!n.has(g))return null;void 0===a[g]&&(a[g]=[]),a[g].push(c.attributes[g])}if(u!==c.morphTargetsRelative)return null;for(var g in c.morphAttributes){if(!o.has(g))return null;void 0===i[g]&&(i[g]=[]),i[g].push(c.morphAttributes[g])}if(s.userData.mergedUserData=s.userData.mergedUserData||[],s.userData.mergedUserData.push(c.userData),e){var d;if(t)d=c.index.count;else{if(void 0===c.attributes.position)return null;d=c.attributes.position.count}s.addGroup(l,d,f),l+=d}}if(t){var E=0,v=[];for(f=0;f<r.length;++f){for(var m=r[f].index,h=0;h<m.count;++h)v.push(m.getX(h)+E);E+=r[f].attributes.position.count}s.setIndex(v)}for(var g in a){var p=this.mergeBufferAttributes(a[g]);if(!p)return null;s.setAttribute(g,p)}for(var g in i){var b=i[g][0].length;if(0===b)break;s.morphAttributes=s.morphAttributes||{},s.morphAttributes[g]=[];for(f=0;f<b;++f){var y=[];for(h=0;h<i[g].length;++h)y.push(i[g][h][f]);var T=this.mergeBufferAttributes(y);if(!T)return null;s.morphAttributes[g].push(T)}}return s},mergeBufferAttributes:function(r){for(var e,t,n,o=0,a=0;a<r.length;++a){var i=r[a];if(i.isInterleavedBufferAttribute)return null;if(void 0===e&&(e=i.array.constructor),e!==i.array.constructor)return null;if(void 0===t&&(t=i.itemSize),t!==i.itemSize)return null;if(void 0===n&&(n=i.normalized),n!==i.normalized)return null;o+=i.array.length}var u=new e(o),s=0;for(a=0;a<r.length;++a)u.set(r[a].array,s),s+=r[a].array.length;return new THREE.BufferAttribute(u,t,n)},interleaveAttributes:function(r){for(var e,t=0,n=0,o=0,a=r.length;o<a;++o){var i=r[o];if(void 0===e&&(e=i.array.constructor),e!==i.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;t+=i.array.length,n+=i.itemSize}var u=new THREE.InterleavedBuffer(new e(t),n),s=0,l=[],f=["getX","getY","getZ","getW"],c=["setX","setY","setZ","setW"],g=0;for(a=r.length;g<a;g++){var d=(i=r[g]).itemSize,E=i.count,v=new THREE.InterleavedBufferAttribute(u,d,s,i.normalized);l.push(v),s+=d;for(var m=0;m<E;m++)for(var h=0;h<d;h++)v[c[h]](m,i[f[h]](m))}return l},estimateBytesUsed:function(r){var e=0;for(var t in r.attributes){var n=r.getAttribute(t);e+=n.count*n.itemSize*n.array.BYTES_PER_ELEMENT}var o=r.getIndex();return e+=o?o.count*o.itemSize*o.array.BYTES_PER_ELEMENT:0},mergeVertices:function(r,e=1e-4){e=Math.max(e,Number.EPSILON);for(var t={},n=r.getIndex(),o=r.getAttribute("position"),a=n?n.count:o.count,i=0,u=Object.keys(r.attributes),s={},l={},f=[],c=["getX","getY","getZ","getW"],g=0,d=u.length;g<d;g++){s[b=u[g]]=[],(A=r.morphAttributes[b])&&(l[b]=new Array(A.length).fill().map(()=>[]))}var E=Math.log10(1/e),v=Math.pow(10,E);for(g=0;g<a;g++){var m=n?n.getX(g):g,h="",p=0;for(d=u.length;p<d;p++)for(var b=u[p],y=(w=r.getAttribute(b)).itemSize,T=0;T<y;T++)h+=`${~~(w[c[T]](m)*v)},`;if(h in t)f.push(t[h]);else{for(p=0,d=u.length;p<d;p++){b=u[p];var w=r.getAttribute(b),A=r.morphAttributes[b],R=(y=w.itemSize,s[b]),H=l[b];for(T=0;T<y;T++){var B=c[T];if(R.push(w[B](m)),A)for(var S=0,x=A.length;S<x;S++)H[S].push(A[S][B](m))}}t[h]=i,f.push(i),i++}}const V=r.clone();for(g=0,d=u.length;g<d;g++){b=u[g];var z=r.getAttribute(b),D=new z.array.constructor(s[b]);w=new THREE.BufferAttribute(D,z.itemSize,z.normalized);if(V.setAttribute(b,w),b in l)for(p=0;p<l[b].length;p++){var M=r.morphAttributes[b][p],X=(D=new M.array.constructor(l[b][p]),new THREE.BufferAttribute(D,M.itemSize,M.normalized));V.morphAttributes[b][p]=X}}return V.setIndex(f),V},toTrianglesDrawMode:function(r,e){if(e===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),r;if(e===THREE.TriangleFanDrawMode||e===THREE.TriangleStripDrawMode){var t=r.getIndex();if(null===t){var n=[],o=r.getAttribute("position");if(void 0===o)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r;for(var a=0;a<o.count;a++)n.push(a);r.setIndex(n),t=r.getIndex()}var i=t.count-2,u=[];if(e===THREE.TriangleFanDrawMode)for(a=1;a<=i;a++)u.push(t.getX(0)),u.push(t.getX(a)),u.push(t.getX(a+1));else for(a=0;a<i;a++)a%2==0?(u.push(t.getX(a)),u.push(t.getX(a+1)),u.push(t.getX(a+2))):(u.push(t.getX(a+2)),u.push(t.getX(a+1)),u.push(t.getX(a)));u.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var s=r.clone();return s.setIndex(u),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),r}};